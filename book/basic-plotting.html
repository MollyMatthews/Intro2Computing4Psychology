<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-07-05 Wed 14:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Basic Plotting with R and Python</title>
<meta name="author" content="Britt Anderson" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Basic Plotting with R and Python</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgae8932e">1. Basic Plotting</a>
<ul>
<li><a href="#orgd736428">1.1. Plotting in R: A tale of two approaches</a></li>
</ul>
</li>
<li><a href="#orgcf1d26b">2. Why Both R and Python? Why Can't I Just Pick One?</a></li>
<li><a href="#org98614a9">3. R</a>
<ul>
<li><a href="#org8b2969f">3.1. Libraries for Plotting</a></li>
<li><a href="#orgd87cb78">3.2. A first taste of plotting in R</a>
<ul>
<li><a href="#org07769d8">3.2.1. Base Plot</a></li>
<li><a href="#orgee679ed">3.2.2. Changing the look of base plot</a></li>
<li><a href="#org3b1fdd4">3.2.3. ggplot</a></li>
</ul>
</li>
<li><a href="#org80fbbe3">3.3. Practice makes perfect</a>
<ul>
<li><a href="#org5586697">3.3.1. Lattice (the third, very powerful, plotting alternative for R)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org19feb6a">4. Python</a>
<ul>
<li><a href="#org7fe67bf">4.1. Interaction Plots</a></li>
<li><a href="#orgd2342ef">4.2. Getting the data</a></li>
<li><a href="#orgf5ed499">4.3. Pandas Read in Text</a></li>
</ul>
</li>
<li><a href="#org707c659">5. Assessment</a></li>
<li><a href="#plotting_assessment">6. Plotting Assessment: R and Python</a>
<ul>
<li><a href="#orgdebf475">6.1. Task</a></li>
<li><a href="#orgfca60fe">6.2. What to submit</a></li>
<li><a href="#org771105c">6.3. Hints</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgae8932e" class="outline-2">
<h2 id="orgae8932e"><span class="section-number-2">1.</span> Basic Plotting</h2>
<div class="outline-text-2" id="text-1">
<p>
In this segment we will experiment with plotting data using programing tools and not just dragging lines on a screen or clicking columns in a spreadsheet. The principal advantage of this approach is that the code becomes the documentation for how to generate a plot. This makes it easy to repeat plots with other data sets or to repeat a plot when we have added to our data collection. We can embed the code in our report and the figure will be generated for us. Never again will we search our computers for a missing image file. In addition, this method makes it easy to alter a figure or plot. If we feel the need to change the background color or font size we can just edit our code and hit enter. The new figure with all our old tweaks appears with the new edits.
</p>

<div style="padding:56.39% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/463525019?h=ef13f4bf90" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
<p><a href="https://vimeo.com/463525019">Ja : Intro to Plotting Module (i2c4p)</a> from <a href="https://vimeo.com/epistemic">Britt Anderson</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
<p>A short intro to the outline of this module on plotting with R and Python.</p>
</div>


<div id="outline-container-orgd736428" class="outline-3">
<h3 id="orgd736428"><span class="section-number-3">1.1.</span> Plotting in R: A tale of two approaches</h3>
<div class="outline-text-3" id="text-1-1">
<p>
R has two main contenders in the plotting domain: base and ggplot. This topic takes a look at both. 
</p>
</div>
</div>
</div>

<div id="outline-container-orgcf1d26b" class="outline-2">
<h2 id="orgcf1d26b"><span class="section-number-2">2.</span> Why Both R and Python? Why Can't I Just Pick One?</h2>
<div class="outline-text-2" id="text-2">
<p>
While it may be <i>theoretically</i> possible to do anything that can be done in one computer language in another (after all <a href="https://www.felienne.com/archives/2974">Excel is Turing complete</a>) it may be <i>practically</i> easier in one language than another.   Thus you want to balance being a jack of all trades, but a master of none, with expertise that runs deep, but is narrow. My experience has been that knowing the basics of a few languages is better when you are trying to stitch something together. You can pull what is good from each and glue them together. You take pieces that are robust and have been well vetted and use your own glue code to create the pipeline for your one off or urgent need. However, for something that you will be using in the long term, or where you contemplate sharing with others, it may be better to dig deep and learn some of the specialist's knowledge in one particular programming language. This is another example of making your tools appropriate to your task. A jack-knife is handy to have, you can do almost anything with it, but it is rarely the best tool for any job (I think the source for this is <a href="https://en.wikipedia.org/wiki/John_Tukey">John Tukey</a>).
</p>

<p>
This analogy is particulary apt when it comes to plotting. While I expect the situation to evolve substantially in the next couple of years (it has greatly over the last few) plotting and data handling are currently easier, more stable, and better documented in R. Thus, even if you gather experimental data from a psychology experiment programmed in python you will often find it more convenient to explore that data in an R environment. But it is good to know more than one way to do things, and to have your own experience for comparison. Here we will generate similar plots with both R and Python for you to draw your own conclusions.
</p>
</div>
</div>

<div id="outline-container-org98614a9" class="outline-2">
<h2 id="org98614a9"><span class="section-number-2">3.</span> R</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org8b2969f" class="outline-3">
<h3 id="org8b2969f"><span class="section-number-3">3.1.</span> Libraries for Plotting</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Plotting in R is not one thing. There are at least three plotting libraries you could choose from in R, and two are very common. <code>Base plot</code> and <code>ggplot</code> are the two most common. They can do similar things, but the libraries authors took very different design approaches. With <i>base</i> you build up your plot line by line, entry by entry. With <i>ggplot</i> you create a description of your plot. It is easier to get nice plots quickly with <i>ggplot</i>. It is easier to tweak a plot to perfection in <i>base.</i> These are my personal opinions and I find that different users feel comfortable in the different libraries. You should try both and draw your own conclusions.
</p>
</div>
</div>
<div id="outline-container-orgd87cb78" class="outline-3">
<h3 id="orgd87cb78"><span class="section-number-3">3.2.</span> A first taste of plotting in R</h3>
<div class="outline-text-3" id="text-3-2">
<p>
First, make some pseudo-data. We can use <a href="https://www.math.csi.cuny.edu/Statistics/R/simpleR/stat007.html">the random number generators</a> of <code>R</code> to supply us some data for plotting.<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>
</p>

<div class="org-src-container">
<pre class="src src-R">xs <span style="color: #008b8b;">&lt;-</span> 1:10
ysquare <span style="color: #008b8b;">&lt;-</span> xs^2
ydouble  <span style="color: #008b8b;">&lt;-</span> 2*ysquare
yrandom  <span style="color: #008b8b;">&lt;-</span> rnorm(10)
mapply(<span style="color: #a020f0;">function</span> (x,y,z,q) {c(x,y,z,q)}, xs, ysquare, ydouble, yrandom)
</pre>
</div>

<pre class="example" id="org6bf80c6">
	  [,1]       [,2]       [,3]       [,4]   [,5]       [,6]       [,7]
[1,] 1.0000000 2.00000000  3.0000000  4.0000000  5.000  6.0000000  7.0000000
[2,] 1.0000000 4.00000000  9.0000000 16.0000000 25.000 36.0000000 49.0000000
[3,] 2.0000000 8.00000000 18.0000000 32.0000000 50.000 72.0000000 98.0000000
[4,] 0.3516467 0.08102127 -0.7312347 -0.6682148 -1.983 -0.2623215  0.1662537
	   [,8]         [,9]     [,10]
[1,]   8.000000   9.00000000  10.00000
[2,]  64.000000  81.00000000 100.00000
[3,] 128.000000 162.00000000 200.00000
[4,]  -1.328868  -0.04187366  -1.70868
</pre>


<p>
We use <code>R</code>'s assignment operator to create a sequence from 1 to 10 for our x values and then create three different y values as deterministic or random values. Then I use a <i>map</i> to apply a function to four arguments to create a <i>tuple</i> with elements from each list. This map takes a function as the first argument. That is, functions can be "data". This function is <i>anonymous</i>. The use of anonymous functions and map's is advanced, so just note the potential power of being able to zip four lists together pretty easily, and worry about whether you can do that later in the course. 
</p>
</div>

<div id="outline-container-org07769d8" class="outline-4">
<h4 id="org07769d8"><span class="section-number-4">3.2.1.</span> Base Plot</h4>
<div class="outline-text-4" id="text-3-2-1">
<div style="padding:56.39% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/463524914?h=5a0c9a1bd9" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
<p><a href="https://vimeo.com/463524914">Jb : Using Base Plot in R (i2c4p)</a> from <a href="https://vimeo.com/epistemic">Britt Anderson</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
<p>One of three main plotting frameworks in R, the base plot package comes ready to use with a base R installation.</p>


<p>
For base plot two primitive commands are <code>plot</code> and <code>lines</code>. Be careful. There is a command <code>line</code> (no 's'). That is not what you will want here.
</p>
<div class="org-src-container">
<pre class="src src-R">plot(xs,ydouble)
</pre>
</div>


<div id="org5ec44e7" class="figure">
<p><img src="./baseplot1.png" alt="baseplot1.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgee679ed" class="outline-4">
<h4 id="orgee679ed"><span class="section-number-4">3.2.2.</span> Changing the look of base plot</h4>
<div class="outline-text-4" id="text-3-2-2">
<div style="padding:56.39% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/463524870?h=38d6437425" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
<p><a href="https://vimeo.com/463524870">Jc : Editing the Aesthetics of a Base R Plot (i2c4p)</a> from <a href="https://vimeo.com/epistemic">Britt Anderson</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
<p>Once you have a base R scatter plot how might you go about changing its appearance?</p>

<p>
You have multiple <i>hidden</i> arguments you can use to change the look of the plot such as the symbols, whether it plots lines or dots, the color, the font size. Always remember to try the help command. Here is just one example. Help is your friend here. Try <code>help(plot)</code> in your R console. 
</p>

<div class="org-src-container">
<pre class="src src-R">plot(xs,ysquare,type = <span style="color: #8b2252;">'b'</span>, frame = F, pch = 19, col = <span style="color: #8b2252;">"red"</span> , ylab = <span style="color: #8b2252;">"y"</span>, lty = 1, lwd = 3)
</pre>
</div>




<p>
How would you include another data series in this plot?
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Our base plot with additional data series added.</label><pre class="src src-R" id="orgcdba705">plot(xs,ysquare,type = <span style="color: #8b2252;">'b'</span>, frame = F, pch = 19, col = <span style="color: #8b2252;">"red"</span> , ylab = <span style="color: #8b2252;">"y"</span>, lty = 1, lwd = 3)
lines(xs,ydouble, pch = 18, col = <span style="color: #8b2252;">"blue"</span>, type = <span style="color: #8b2252;">"b"</span> , lty = 2, lwd = 1)
lines(xs,yrandom, pch = 17, col = <span style="color: #8b2252;">"green"</span> , type = <span style="color: #8b2252;">"l"</span>, lty=3, lwd = 4)
legend(<span style="color: #8b2252;">"topleft"</span>, legend = c(<span style="color: #8b2252;">"Line 1"</span>, <span style="color: #8b2252;">"Line 2"</span>, <span style="color: #8b2252;">"Line 3"</span>), col = c(<span style="color: #8b2252;">"red"</span>,<span style="color: #8b2252;">"blue"</span>,<span style="color: #8b2252;">"green"</span>),
       lty = 1:3, cex = 0.8)
</pre>
</div>


<div id="org26cf32f" class="figure">
<p><img src="./baseplot3.png" alt="baseplot3.png" />
</p>
</div>

<p>
To figure out what the <code>lines</code> are doing don't forget the help commands: <code>?lines</code>.
</p>

<p>
Who wants to try and recreate this in Excel or SPSS? As a quick test can you change the color and line type of each series?
</p>
</div>
</div>

<div id="outline-container-org3b1fdd4" class="outline-4">
<h4 id="org3b1fdd4"><span class="section-number-4">3.2.3.</span> ggplot</h4>
<div class="outline-text-4" id="text-3-2-3">
<div style="padding:56.39% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/463524796?h=30f0620069" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
<p><a href="https://vimeo.com/463524796">Jd : GGplot in R (i2c4p)</a> from <a href="https://vimeo.com/epistemic">Britt Anderson</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
<p>The second main plotting framework for R (ggplot2) offers a different graphical model, but some very nice out of the box aesthetics.</p>
<p>
<code>ggplot</code> uses a model where you build things up  bit by bit all in one line, and you can keep adding to the same object. For instance. 
</p>

<p>
Note that people tend to say "ggplot", but they always mean <code>ggplot2</code>. Note the number "2". If you do not have <code>ggplot</code> you will need to install it, and when you do you will note that <code>ggplot</code> requires a lot of other packages to function properly. One reason to prefer the base package is a greater simplicity of installation. However, once you move on beyond simple 2d line and scatter plots base plotting too grows more complex.
</p>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #008b8b;">library</span>(ggplot2)
p  <span style="color: #008b8b;">&lt;-</span> ggplot(data = data.frame(<span style="color: #8b2252;">"x"</span> = xs, <span style="color: #8b2252;">"y1"</span> = ysquare, <span style="color: #8b2252;">"y2"</span> = ydouble, <span style="color: #8b2252;">"y3"</span> = yrandom), aes(x = xs, y = ysquare, col= <span style="color: #8b2252;">'r'</span>))
p <span style="color: #008b8b;">&lt;-</span> p + geom_point() + geom_line() + theme(legend.position = c(0.2,0.65)) + geom_line(aes(x=x,y=ydouble, col = <span style="color: #8b2252;">"blue"</span>)) + geom_line(aes(y=yrandom,col = <span style="color: #8b2252;">"green"</span>))
ggsave(<span style="color: #8b2252;">"ggplot1.png"</span>, width = 8, height = 5, units = <span style="color: #8b2252;">"cm"</span>) 
</pre>
</div>


<div id="orgc86fa8b" class="figure">
<p><img src="./ggplot1.png" alt="ggplot1.png" />
</p>
</div>

<p>
Notice that here we are saving the results of our calls to <code>ggplot</code> as a variable. We can either type that variable at the command line to see the plot, or we can use that variable to save our plot as a file. The style is quite different from the base plot above, and can be a bit harder to begin with. We are creating an object. Initially, in the line above where we first use ggplot we don't actually plot anything. We just create our plotting object and populate the data. Later on we use a method to plot this data with a particular syle, the point, and then again with the line.
</p>
</div>
</div>
</div>

<div id="outline-container-org80fbbe3" class="outline-3">
<h3 id="org80fbbe3"><span class="section-number-3">3.3.</span> Practice makes perfect</h3>
<div class="outline-text-3" id="text-3-3">
<p>
To get some hands on experience with plotting I suggest creating <a href="https://en.wikipedia.org/wiki/Scatter_plot">scatter plots</a> and <a href="https://en.wikipedia.org/wiki/Box_plot">box plots</a> with R using one of the built in data sets. 
</p>
<ol class="org-ol">
<li>Using the R data set <code>mtcars</code> create in both base plot and ggplot a scatterplot of <b>mpg</b> and <b>wt</b>. What would you expect this to show even before you plot it. One way to make sure your code is doing what you want is to visualize what you expect. If that is not what you see then either your code is wrong or your understanding of the functions and what they do is wrong. Either way you know something is not right and you can set about fixing it.</li>
<li>Using the R data set <code>ToothGrowth</code> generate boxplots for <code>len</code> and <code>dose</code>. If you are feeling creative overlay the data points on top of the box plot.
Here are a couple of links to help you get started:
<ol class="org-ol">
<li><a href="http://www.sthda.com/english/wiki/box-plots-r-base-graphs">box-plots-r-base-graphs</a></li>
<li><a href="http://www.sthda.com/english/wiki/scatter-plots-r-base-graphs">scatter-plots-r-base-graphs</a></li>
<li><a href="http://www.sthda.com/english/wiki/qplot-quick-plot-with-ggplot2-r-software-and-data-visualization#scatter-plots">ggplot2-scatter-plots</a></li>
<li><a href="http://www.sthda.com/english/wiki/ggplot2-box-plot-quick-start-guide-r-software-and-data-visualization">ggplot2-boxplots</a></li>
</ol></li>
</ol>
</div>
<div id="outline-container-org5586697" class="outline-4">
<h4 id="org5586697"><span class="section-number-4">3.3.1.</span> Lattice (the third, very powerful, plotting alternative for R)</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
     <a href="https://stat.ethz.ch/R-manual/R-devel/library/lattice/html/Lattice.html">
Lattice Plot Overview</a>
</p>

<p>
When should you consider using <code>lattice</code>? When multivariate data are at play. One of the good examples of this that comes up often in psychology is the interaction plot. For analyses of variance you frequently encounter pairs of factors, say age and weight, that you want to plot against each other, and where you want to separate out the effect of a third factor on that relationship (e.g. gender). 
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org19feb6a" class="outline-2">
<h2 id="org19feb6a"><span class="section-number-2">4.</span> Python</h2>
<div class="outline-text-2" id="text-4">
<div style="padding:56.39% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/463524647?h=9fa558f167" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
<p><a href="https://vimeo.com/463524647">Je : Plotting with Python (i2c4p)</a> from <a href="https://vimeo.com/epistemic">Britt Anderson</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
<p>Matplotlib is the workhorse plotting library for python. Yet another different approach to plotting from those in R it can produce graphics of equally high quality.</p>

<p>
Python has many plotting libraries too. <a href="https://matplotlib.org/">Matplotlib</a> is very popular and the most well established. It is leveraged by the Pandas package to make plotting available from Pandas. Other plotting libraries worth checking out are <a href="https://seaborn.pydata.org/">Seaborn</a> and <a href="https://docs.bokeh.org/en/latest/">Bokeh</a>. Bokeh seeks to use the same graphics grammar as ggplot. Lastly, <a href="https://plotly.com/python/">Plotly</a> has become popular and can make interactive plots as well.
</p>
</div>
<div id="outline-container-org7fe67bf" class="outline-3">
<h3 id="org7fe67bf"><span class="section-number-3">4.1.</span> Interaction Plots</h3>
<div class="outline-text-3" id="text-4-1">
<p>
This example is included because SPSS, a common and powerful statistical package used by many psychologists, makes interaction plots difficult to achieve (or so I am told - I have never used SPSS). If you are taking an advanced statistics course knowing how to create these kinds of plots could be very useful. 
</p>
</div>
</div>
<div id="outline-container-orgd2342ef" class="outline-3">
<h3 id="orgd2342ef"><span class="section-number-3">4.2.</span> Getting the data</h3>
<div class="outline-text-3" id="text-4-2">
<p>
For this example we will use the data from <a href="http://personality-project.org/r/datasets/heating.txt">http://personality-project.org/r/datasets/heating.txt</a>, but you don't need to download it manually. We can do this from within python itself. Instead of using the request library (a general library in python for making internet requests) we will use the <code>read_csv</code> functionality of pandas to read data from a url (universal resource locator - an address on the world wide web). <sup><a id="fnr.2" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>
</p>
</div>
</div>

<div id="outline-container-orgf5ed499" class="outline-3">
<h3 id="orgf5ed499"><span class="section-number-3">4.3.</span> Pandas Read in Text</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">
<pre class="src src-python" id="org454c2e1"><span style="color: #a020f0;">import</span> os
os.chdir(<span style="color: #8b2252;">"."</span>)
</pre>
</div>

<p>
The above code block is a little bit of housekeeping to make sure it is easy for me to embed the plots. It is not too important here, but I wanted to leave it visible in case you run into problems. 
</p>


<div class="org-src-container">
<pre class="src src-python">
<span style="color: #a020f0;">import</span> pandas <span style="color: #a020f0;">as</span> pd
<span style="color: #a0522d;">url</span> = <span style="color: #8b2252;">"http://personality-project.org/r/datasets/heating.txt"</span>
<span style="color: #a0522d;">d</span> = pd.read_csv(url, sep=<span style="color: #8b2252;">"\t"</span>)
d.columns
</pre>
</div>



<p>
For this exercise, we want to get plots of degree days versus therms, but we want to do it separately for each type of house to see if there is an <i>interaction</i>. That is, is the relationship between degree days and therms different for the different types of houses. Types of houses <i>interacts</i> with <code>degreedays</code> when we want to predict <code>therms</code>. 
</p>

<p>
We will also use some additional python modules to help us make this easier, specifically <code>scipy</code>, <code>matplotlib</code>, and <code>statsmodels</code>. These can be installed via <code>pip</code>.
</p>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> statsmodels.graphics.factorplots <span style="color: #a020f0;">import</span> interaction_plot
<span style="color: #a020f0;">from</span> matplotlib <span style="color: #a020f0;">import</span> pyplot <span style="color: #a020f0;">as</span> plt
interaction_plot(d[<span style="color: #8b2252;">'degreedays'</span>], d[<span style="color: #8b2252;">'Location'</span>], d[<span style="color: #8b2252;">'therms'</span>])
plt.savefig(f)
f
</pre>
</div>


<div id="org8c1a238" class="figure">
<p><img src="example-os.png" alt="example-os.png" />
</p>
</div>


<p>
This gives us a "connect-the-dots" sort of look to our data. We would prefer to <a href="https://en.wikipedia.org/wiki/Linear_least_squares">fit a line</a>, a <i>best</i> possible line, to our data. We want to pick the line that runs through the data points and is as close as possible (measured in the y direction) to all the data points. The techniques for doing this, and the theory, come from your stats courses, but we can use those tools here without explanation just to get some practice with the libraries and functions that will later come in handy. 
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> statsmodels.formula.api <span style="color: #a020f0;">import</span> ols
<span style="color: #a0522d;">ols_d</span> = ols(formula=<span style="color: #8b2252;">"therms ~ degreedays * Location"</span>, data=d)
my_fits = ols_d.fit()
plt.clf()
f = plt.figure()
a = f.gca()
ip1 = interaction_plot(d[<span style="color: #8b2252;">'degreedays'</span>], d[<span style="color: #8b2252;">'Location'</span>], my_fits.fittedvalues, plottype=<span style="color: #8b2252;">"line"</span>, ax=a)
ip2 = interaction_plot(d[<span style="color: #8b2252;">'degreedays'</span>], d[<span style="color: #8b2252;">'Location'</span>], d[<span style="color: #8b2252;">'therms'</span>], plottype=<span style="color: #8b2252;">'scatter'</span>, ax=a)
lines, labels = f.axes[0].get_legend_handles_labels()
a.legend_ = <span style="color: #008b8b;">None</span>
f.legend(lines[0:3], labels[0:3], loc=<span style="color: #8b2252;">'upper left'</span>, bbox_to_anchor=(0.15, 0.85))
plt.savefig(fn)
fn
</pre>
</div>


<div id="org9b66b59" class="figure">
<p><img src="./py-inter-fit-plt.png" alt="py-inter-fit-plt.png" />
</p>
</div>



<p>
Note that figuring out how to get the legend only for the plot with the lines and not a redundant legend for the scatterplot, and to place it properly took me about an hour. This is not as easy a system to get started in as the <code>R</code> commands are. 
</p>
</div>
</div>
</div>

<div id="outline-container-org707c659" class="outline-2">
<h2 id="org707c659"><span class="section-number-2">5.</span> Assessment</h2>
<div class="outline-text-2" id="text-5">
<p>
Words of warning: do not think you can just cut and paste the R commands with the Python commands and vice versa. You will need to look up how to do the things in python that we do in R and vice versa by consulting online sources. In some cases the easy thing in R is hard in python and vice versa.
</p>
</div>
</div>

<div id="outline-container-plotting_assessment" class="outline-2">
<h2 id="plotting_assessment"><span class="section-number-2">6.</span> Plotting Assessment: R and Python</h2>
<div class="outline-text-2" id="text-plotting_assessment">
</div>


<div id="outline-container-orgdebf475" class="outline-3">
<h3 id="orgdebf475"><span class="section-number-3">6.1.</span> Task</h3>
<div class="outline-text-3" id="text-6-1">
<ol class="org-ol">
<li>Do exactly what we did in the topic, but reverse which language you use to do each.</li>
<li>Use python functions to generate a sequence (for the x), a function to get a y from the x, and a random number generator to get y<sub>randoms</sub> as long as the x and y values, and then generate a line and scatter plot for your x and y's and y<sub>random</sub>'s all on the same plot.</li>
<li>The interaction plot should be done with R</li>
</ol>
</div>
</div>

<div id="outline-container-orgfca60fe" class="outline-3">
<h3 id="orgfca60fe"><span class="section-number-3">6.2.</span> What to submit</h3>
<div class="outline-text-3" id="text-6-2">
<p>
An *.org file that includes code blocks for the plots (and the included files for the plots) that accomplish the assigned tasks. It should export to a nice html.
</p>
</div>
</div>

<div id="outline-container-org771105c" class="outline-3">
<h3 id="org771105c"><span class="section-number-3">6.3.</span> Hints</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>R can read in data from a url as well as pandas. See <a href="https://stackoverflow.com/questions/6299220/access-a-url-and-read-data-with-r">this</a>stack overflow question/answer.</li>
<li>R has a <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/interaction.plot">built in function</a> for interaction plots that might work.</li>
<li>It might be easier with <code>ggplot</code>. Here is a <a href="https://sebastiansauer.github.io/vis_interaction_effects/">blog</a> showing how.</li>
<li><a href="https://docs.python.org/3/library/random.html">Random numbers</a> are easy in python.</li>
<li>What you need for <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.plot.line.html">plotting lines</a> in python is shown in the interaction plot example - just skip the "ols" model part.</li>
</ul>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
The course notes are being generated from org mode files using babel source code blocks. Getting these blocks right can be tricky and may involve language specific adjustments. Please consult the <code>org</code> files for details on the <i>header</i> fields, their keywords, and how I use them to change the outputs. Note specifically that the colons are extremely important. The directory you set up to work in may also need to be changed if you recompile these notes locally.  
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
Notice that in this file we will execute both R code and Python code mixed with text. We will run  separate sessions of R and python that allow us to mix and share variables within the code blocks for each language.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="date">Date: 2023-02-10 Fri 00:00</p>
<p class="author">Author: Britt Anderson</p>
<p class="date">Created: 2023-07-05 Wed 14:49</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>